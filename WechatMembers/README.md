# 🗂️ 微信群成员管理脚本使用手册

## 🤖 简介
本脚本用于自动化获取微信PC端群聊成员信息，并支持基于自定义名单进行成员匹配检查。通过UI自动化技术实现成员信息抓取，结果保存为CSV文件。

本脚本修改自 [ka5cas](https://blog.csdn.net/qq_43094622/article/details/130211289) 编写的脚本，遵循[ CC 4.0 BY-SA ](http://creativecommons.org/licenses/by-sa/4.0/)版权协议。

⚠️本脚本不具有联网功能，一切操作均在本地进行。

![Python](https://img.shields.io/badge/Python-3.6+-blue?style=for-the-badge) ![License](https://img.shields.io/badge/License-GPL_3.0-green?style=for-the-badge)

## 🚀 功能特性
- ✅ 自动检测微信进程
- 👥 获取群成员信息（群昵称+微信昵称）
- 💾 CSV格式保存成员数据
- 🔍 自定义名单匹配检查
- ❌ 未匹配成员列表输出

## 🛠️ 环境要求
- 🖥️ Windows操作系统
- 🐍 Python 3.6+
- 💬 微信PC客户端（已登录状态）

## 📦 依赖安装
```bash
pip install pywinauto psutil pandas numpy
```
## 🎮 使用步骤

### 🔰 基础准备

1. 登录微信PC客户端
2. 打开目标群聊窗口
3. 进入成员列表界面：
	- 👉 点击群聊标题 -> 选择「聊天成员」
	- **❗必须点击「查看更多」**展开完整成员列表

### ⚡ 脚本执行

1. 准备名单文件（可选）：
	- 📝 创建 `name_list.txt` 在脚本同目录
	- 📄 每行一个待匹配的群昵称
2. 运行脚本：

	```bash
	python wechat_group_members.py
	```

1. ⏳ 等待倒计时（20秒）：
	- 此时需确保成员列表界面保持打开
2. 🔘 选择匹配模式：
	- 输入`y`进行名单匹配 ▶️
	- 输入`n`仅导出成员列表 ⏹️

### 📂 输出文件

3. `all_members.csv`：
	- 📊 包含两列：群昵称、微信昵称
	- 🗃️ 自动保存至脚本目录
4. 控制台输出：
	- 🔴 显示未匹配成功的名单
	- 📈 统计总成员数量

## 📋 输入文件格式

`name_list.txt`示例：

```markdown
张三
李四（工作）
王五
```

## ⚠️ 注意事项

1. 微信版本兼容性：
	- 🔄 支持最新微信PC端(3.9+)
	- 🛠️ 如遇控件识别问题可尝试重装微信
2. 窗口要求：
	- 🖼️ 保持微信窗口在前台
	- 📌 不可最小化窗口
	- 🔍 确保成员列表完全展开
3. 进程问题：
	- 🔄 发现多个微信进程时需重启客户端
	- 🔒 确保只运行一个微信实例
4. 匹配规则：
	- 🎯 模糊匹配（包含即视为匹配）
	- 🔠 区分大小写和特殊符号
	- ➕ 支持部分匹配（如"李四"可匹配"李四_工作号"）

## ❓ 常见问题处理

### 🚨 错误：找不到WeChat.exe

- 🔍 确认微信客户端已启动
- 🛡️ 检查杀毒软件是否阻止进程访问
- 👨💻 以管理员身份运行脚本

### 🚨 错误：未找到聊天成员窗口

- 👀 确认已正确打开成员列表
- 🔍 检查是否点击了「查看更多」
- 🔄 尝试重新聚焦微信窗口

### 🚨 匹配结果不全

- 📝 检查name_list.txt编码格式（需UTF-8）
- 🔡 确认群昵称包含换行或特殊空格
- ⚙️ 尝试完全匹配模式（修改代码中的`if i in j`为`if i == j`）

## 🧠 代码结构

```python
"""
✨ 主要函数说明：
1. get_wechat_pid() - 获取微信进程ID
2. get_name_list() - 提取成员信息并保存CSV
3. match() - 主控制流程
4. 🛡️ 异常处理机制包含进程检测和窗口验证
"""
```

## 📂文件架构

```
WechatMembers/
├── index.py        # 主程序
├── name_list.txt   # 匹配文件
└── README.md       # 说明文档
```
